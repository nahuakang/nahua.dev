<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="kangnahua [at] gmail dot com Nahua Kang Berlin, DE Nahua Kang ">
<meta name="description" content="@bobahop on Exercism:
You&amp;rsquo;re very welcome!
As for lifetimes&amp;hellip;a HashSet of str references is being returned. They can&amp;rsquo;t be references to str values created in anagrams_for, since those values would go out of scope and be destroyed at the end of the anagrams_for function. So they need to reference something being passed in. The HashSet is populated by references to the values in possible_anagrams, so we have to specify to the compiler that we are sure that the lifetime of the values referenced in the return HashSet is as long as for the values referenced in possible_anagrams." />
<meta name="keywords" content="blog, software development, programming, web development, untagged" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/2020/09/rust-what-is-lifetime/" />


    <title>
        
            Rust What Is Lifetime :: Nahua Kang 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.5dcefbf8102eb536dd3e2de53ffebfa58599ab2435c241a0db81728a5e015f2e.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#fff">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#fff">
<meta itemprop="name" content="Rust What Is Lifetime">
<meta itemprop="description" content="@bobahop on Exercism:
You&rsquo;re very welcome!
As for lifetimes&hellip;a HashSet of str references is being returned. They can&rsquo;t be references to str values created in anagrams_for, since those values would go out of scope and be destroyed at the end of the anagrams_for function. So they need to reference something being passed in. The HashSet is populated by references to the values in possible_anagrams, so we have to specify to the compiler that we are sure that the lifetime of the values referenced in the return HashSet is as long as for the values referenced in possible_anagrams.">
<meta itemprop="datePublished" content="2020-09-13T13:48:37&#43;02:00" />
<meta itemprop="dateModified" content="2020-09-13T13:48:37&#43;02:00" />
<meta itemprop="wordCount" content="332">
<meta itemprop="image" content="/"/>



<meta itemprop="keywords" content="untagged," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Rust What Is Lifetime"/>
<meta name="twitter:description" content="@bobahop on Exercism:
You&rsquo;re very welcome!
As for lifetimes&hellip;a HashSet of str references is being returned. They can&rsquo;t be references to str values created in anagrams_for, since those values would go out of scope and be destroyed at the end of the anagrams_for function. So they need to reference something being passed in. The HashSet is populated by references to the values in possible_anagrams, so we have to specify to the compiler that we are sure that the lifetime of the values referenced in the return HashSet is as long as for the values referenced in possible_anagrams."/>





    <meta property="article:published_time" content="2020-09-13 13:48:37 &#43;0200 CEST" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text-1" style="color:#A9DC76">echo</span>
            &nbsp;
            <span class="logo__text-2">Hello World</span>
            <span class="logo__cursor" style="background-color:#fe9051"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Blog</a></li><li><a href="/projects/">Projects</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>2 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="/posts/2020/09/rust-what-is-lifetime/">Rust What Is Lifetime</a>
            </h1>

            

            <div class="post-content">
                <p>@bobahop on Exercism:</p>
<p>You&rsquo;re very welcome!</p>
<p>As for lifetimes&hellip;a HashSet of str references is being returned. They can&rsquo;t be references to str values created in anagrams_for, since those values would go out of scope and be destroyed at the end of the anagrams_for function. So they need to reference something being passed in. The HashSet is populated by references to the values in possible_anagrams, so we have to specify to the compiler that we are sure that the lifetime of the values referenced in the return HashSet is as long as for the values referenced in possible_anagrams.</p>
<p>The common idiom of using &lsquo;a doesn&rsquo;t really help to understand. This might make it clearer&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">anagrams_for</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">&#39;possible_anagrams_lifetime</span><span style="color:#f92672">&gt;</span>(word: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span>, possible_anagrams: <span style="color:#66d9ef">&amp;</span>[<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">&#39;possible_anagrams_lifetime</span> <span style="color:#66d9ef">str</span>]) -&gt; <span style="color:#a6e22e">HashSet</span><span style="color:#f92672">&lt;&amp;</span><span style="color:#a6e22e">&#39;possible_anagrams_lifetime</span> <span style="color:#66d9ef">str</span><span style="color:#f92672">&gt;</span> {}
</code></pre></div><p>It&rsquo;s way more verbose, which is why it&rsquo;s not done, but it may help to make it clearer what we&rsquo;re telling the compiler. If we were not passing in word: &amp;str then [lifetime elision] would allow us to omit all of the specified lifetimes, as we then wouldn&rsquo;t have to tell the compiler if the output referenced word or possible_anagrams.</p>
<p>Of course, we can&rsquo;t return <code>HashSet&lt;str&gt;</code> because, as the compiler tells us, it can&rsquo;t determine the length of the str at compile time.</p>
<p>So, another way to do this would be return a heap-allocated object whose size of its pointer on the stack is known. This won&rsquo;t be accepted by the tests, but in the world one could do&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-rust" data-lang="rust"><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">anagrams_for</span>(word: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span>, possible_anagrams: <span style="color:#66d9ef">&amp;</span>[<span style="color:#f92672">&amp;</span><span style="color:#66d9ef">str</span>]) -&gt; <span style="color:#a6e22e">HashSet</span><span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> {
...
anagrams.insert(possibility.to_string());
</code></pre></div><p>For just a few values it&rsquo;s not a big deal, but if we were dealing with a lot of values we would want the performance of keeping them references and leading the compiler by the hand by the lifetime annotations.</p>
<p>You might be interested in a [detailed description of lifetimes]. It&rsquo;s somewhat long and it takes a while before it starts getting very interesting, but by the end you may think it&rsquo;s been worth the time reading it.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/untagged">untagged</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>332 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-09-13 13:48 &#43;0200</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    

                    
                        <span class="button next">
                            <a href="/posts/2020/09/rust-for-loop-and-iterators/">
                                <span class="button__text">Rust for Loop and Iterators</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="/">Nahua Kang</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
